(function(){"use strict";var e=this.window||this.global,t={};if(e.setTimeout){var r=e.setTimeout;t.setTimeout=function(e,t){var i=this,n=Array.prototype.slice.call(arguments,2);return r(e instanceof Function?function(){e.apply(i,n)}:e,t)}}if(e.setInterval){var i=e.setInterval;t.setInterval=function(e,t){var r=this,n=Array.prototype.slice.call(arguments,2);return i(e instanceof Function?function(){e.apply(r,n)}:e,t)}}var n=function(){function e(e,r){t._numToComplete-=1,t.progress&&t.progress(e),t._numToComplete<=0&&t.done&&t.done(t._valArray),r&&t._queue.length>0&&t.pop(r)}var t=this;try{Object.defineProperty(this,"_valArray",{value:[],writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_queue",{value:[],writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_numToComplete",{value:0,writable:!0,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_progress",{value:e,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_started",{value:!1,writable:!0,enumerable:!1,configurable:!1})}catch(r){this._valArray=[],this._queue=[],this._numToComplete=0,this._progress=e,this._started=!1}};n.prototype={enqueue:function(e,t){t=t||{};var r=Array.prototype.slice.call(t.args||[]),i=this;return i._queue.push(function(n){if(t.callback_required)r.push(function(e){i._valArray.push(e),i._progress(e,n)}),t.fn.apply(e,r);else{var s=t.fn.apply(e,r);i._valArray.push(s),i._progress(s,n)}}),this.finished()?this.pop():this._numToComplete+=1,this._queue.length},pop:function(e){t.setTimeout.call(this,this._queue.shift(),0,e)},start:function(e){if(this._started=!0,e)this.pop(!0);else for(var t=this._queue.length;--t>=0;)this.pop()},finished:function(){return!!this._started&&0===this._queue.length},started:function(){return!!this._started}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports.AsyncQueue=n):e.window?e.window.AsyncQueue=n:this.AsyncQueue=n}).call(this);
