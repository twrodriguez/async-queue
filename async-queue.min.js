(function(){"use strict";var e=this.window||this.global,t={};if(e.setTimeout){var r=e.setTimeout;t.setTimeout=function(e,t){var n=this,i=Array.prototype.slice.call(arguments,2);return r(e instanceof Function?function(){e.apply(n,i)}:e,t)}}if(e.setInterval){var n=e.setInterval;t.setInterval=function(e,t){var r=this,i=Array.prototype.slice.call(arguments,2);return n(e instanceof Function?function(){e.apply(r,i)}:e,t)}}var i=function(){function e(e,r){t._numToComplete-=1,t.progress&&t.progress(e),t._numToComplete<=0&&t.done&&t.done(t._valArray),r&&t._queue.length>0&&t.pop(r)}var t=this;try{Object.defineProperty(this,"_valArray",{value:[],writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_queue",{value:[],writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_numToComplete",{value:0,writable:!0,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_progress",{value:e,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_started",{value:!1,writable:!0,enumerable:!1,configurable:!1})}catch(r){this._valArray=[],this._queue=[],this._numToComplete=0,this._progress=e,this._started=!1}};i.prototype={enqueue:function(e,t){t=t||{};var r=Array.prototype.slice.call(t.args||[]),n=this;return n._queue.push(function(i){if(t.callback_required)r.push(function(e){n._valArray.push(e),n._progress(e,i)}),t.fn.apply(e,r);else{var u=t.fn.apply(e,r);n._valArray.push(u),n._progress(u,i)}}),this._numToComplete+=1,this._queue.length},pop:function(e){t.setTimeout.call(this,this._queue.shift(),0,e)},start:function(e){if(this._started=!0,e)this.pop(!0);else for(var t=this._queue.length;--t>=0;)this.pop()},finished:function(){return!!this._started&&0===this._queue.length},started:function(){return!!this._started}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.AsyncQueue=i):e.window?e.window.AsyncQueue=i:this.AsyncQueue=i}).call(this);